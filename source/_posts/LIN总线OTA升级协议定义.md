---
title: LINæ€»çº¿OTAå‡çº§åè®®å®šä¹‰
date: 2025-07-14
tags: [åµŒå…¥å¼, Cè¯­è¨€]
---
## ä¸€ã€LIN IDæšä¸¾å®šä¹‰
### 1. åŸºæœ¬IDæšä¸¾
```c
typedef enum
{
    gID_OtapCmd_c = 0x31,
    gID_OtapGetStatus_c,
    gID_OtapData_c
} lin_id_t;
```

### 2. IDåŠŸèƒ½è¯´æ˜
+ **gID_OtapCmd_c (0x31)**ï¼šLINä¸»èŠ‚ç‚¹æŒ‡ç¤ºä»èŠ‚ç‚¹å¼€å§‹/ç»“æŸå›ºä»¶ä¼ è¾“çš„å‘½ä»¤ID
+ **gID_OtapGetStatus_c**ï¼šLINä¸»èŠ‚ç‚¹è·å–ä»èŠ‚ç‚¹å®æ—¶çŠ¶æ€çš„çŠ¶æ€æŸ¥è¯¢ID
+ **gID_OtapData_c**ï¼šLINä¸»èŠ‚ç‚¹å‘ä»èŠ‚ç‚¹ä¼ è¾“å®é™…å›ºä»¶æ•°æ®çš„æ•°æ®ä¼ è¾“ID



## äºŒã€å‘½ä»¤ä¸çŠ¶æ€æšä¸¾å®šä¹‰
### 1. gID_OtapCmd_cå‘½ä»¤æšä¸¾
```c
typedef enum
{
    LIN_OTA_CMD_NONE = 0x00,  // æ— å‘½ä»¤
    LIN_OTA_CMD_START,        // å¼€å§‹ä¼ è¾“å‘½ä»¤
    LIN_OTA_CMD_END,          // ç»“æŸä¼ è¾“å‘½ä»¤
    LIN_OTA_CMD_CONTINUE      // ç»§ç»­ä¼ è¾“å‘½ä»¤
} lin_ota_cmd_c;
```

### 2. gID_OtapGetStatus_cçŠ¶æ€æšä¸¾
```c
typedef enum
{
    LIN_OTA_STATUS_IDLE = 0x00,   // ç©ºé—²çŠ¶æ€
    LIN_OTA_STATUS_READY,         // å‡†å¤‡å°±ç»ªçŠ¶æ€
    LIN_OTA_STATUS_RUNNING,       // ä¼ è¾“è¿›è¡Œä¸­çŠ¶æ€
    LIN_OTA_STATUS_FINISH,        // ä¼ è¾“å®ŒæˆçŠ¶æ€
    LIN_OTA_STATUS_ABORT          // ä¼ è¾“ä¸­æ­¢çŠ¶æ€
} lin_ota_status_t;
```



## ä¸‰ã€æ•°æ®å¸§æ ¼å¼å®šä¹‰
### 1. å„IDæ•°æ®å¸§ç»“æ„å¯¹æ¯”
| IDç±»å‹ | æ•°æ®å¸§é•¿åº¦ | æ•°æ®å¸§è¯¦ç»†å®šä¹‰ |
| --- | --- | --- |
| gID_OtapCmd_c | 8å­—èŠ‚ | ä¼ è¾“çŠ¶æ€ç  + æ‰‡åŒºå·(1B) + å›ºä»¶ç‰ˆæœ¬å·(2B) + ä¿ç•™å­—æ®µ(4B) |
| gID_OtapGetStatus_c | 8å­—èŠ‚ | ä¼ è¾“çŠ¶æ€ç  + æ‰‡åŒºå·(1B) + æ‰‡åŒºCRCæ ¡éªŒç (2B) + ä¿ç•™å­—æ®µ(4B) |
| gID_OtapData_c | 8å­—èŠ‚ | å…¨éƒ¨ä¸ºå›ºä»¶æ•°æ®(å®é™…ä¼ è¾“æ—¶å¯é€šè¿‡å¤šå¸§æ‹¼æ¥å®ç°æ›´å¤§æ•°æ®é‡ä¼ è¾“) |


### 2. å­—æ®µè¯¦ç»†è¯´æ˜
+ **ä¼ è¾“çŠ¶æ€ç **ï¼šä½¿ç”¨`lin_ota_cmd_c`æšä¸¾å€¼(ä»…gID_OtapCmd_c)æˆ–`lin_ota_status_t`æšä¸¾å€¼(ä»…gID_OtapGetStatus_c)
+ **æ‰‡åŒºå·**ï¼šæŒ‡å®šæ•°æ®å­˜å‚¨çš„ç›®æ ‡æ‰‡åŒº(0-255)
+ **å›ºä»¶ç‰ˆæœ¬å·**ï¼š2å­—èŠ‚å¤§ç«¯åºç‰ˆæœ¬å·(å¦‚0x0100è¡¨ç¤º1.00ç‰ˆæœ¬)
+ **æ‰‡åŒºCRCæ ¡éªŒç **ï¼š2å­—èŠ‚å¤§ç«¯åºCRCæ ¡éªŒå€¼ï¼Œç”¨äºéªŒè¯æ‰‡åŒºæ•°æ®å®Œæ•´æ€§
+ **ä¿ç•™å­—æ®µ**ï¼šä¿ç•™æœªæ¥æ‰©å±•ä½¿ç”¨ï¼Œå½“å‰åº”ç½®ä¸º0



## å››ã€OTAå‡çº§æµç¨‹è¯¦è§£
### 1. åˆå§‹åŒ–ä¸å¼€å§‹ä¼ è¾“é˜¶æ®µ
1. LINä¸»èŠ‚ç‚¹é€šè¿‡`gID_OtapCmd_c`å‘é€å¼€å§‹ä¼ è¾“å‘½ä»¤ï¼š
    - çŠ¶æ€ç ï¼š`LIN_OTA_CMD_START`
    - æ‰‡åŒºå·ï¼š0
    - å›ºä»¶ç‰ˆæœ¬å·ï¼š0x0100(å¤§ç«¯åº)
    - ä¿ç•™å­—æ®µï¼š0x00000000
2. LINä»èŠ‚ç‚¹æ”¶åˆ°å‘½ä»¤åè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œå‡†å¤‡æ¥æ”¶æ•°æ®
3. LINä¸»èŠ‚ç‚¹é€šè¿‡`gID_OtapGetStatus_c`æŸ¥è¯¢çŠ¶æ€ï¼š
    - æœŸæœ›ä»èŠ‚ç‚¹è¿”å›ï¼š`LIN_OTA_STATUS_READY`çŠ¶æ€ç 



### 2. æ•°æ®ä¼ è¾“é˜¶æ®µ(ä»¥æ‰‡åŒº1ä¸ºä¾‹)
4. LINä¸»èŠ‚ç‚¹é€šè¿‡`gID_OtapData_c`å‘é€1Kå­—èŠ‚å›ºä»¶æ•°æ®
5. LINä»èŠ‚ç‚¹å­˜å‚¨æ•°æ®å¹¶è®¡ç®—æ‰‡åŒºCRCæ ¡éªŒç 
6. LINä¸»èŠ‚ç‚¹å†æ¬¡æŸ¥è¯¢çŠ¶æ€ï¼š
    - æœŸæœ›ä»èŠ‚ç‚¹è¿”å›ï¼š`LIN_OTA_STATUS_FINISH`çŠ¶æ€ç 
    - æ ¡éªŒç ï¼šæ‰‡åŒº1çš„CRCæ ¡éªŒç (å¤§ç«¯åº)
7. LINä¸»èŠ‚ç‚¹å‘é€ç»§ç»­ä¼ è¾“å‘½ä»¤åˆ°æ‰‡åŒº1ï¼š
    - çŠ¶æ€ç ï¼š`LIN_OTA_CMD_CONTINUE`
    - æ‰‡åŒºå·ï¼š1
    - å›ºä»¶ç‰ˆæœ¬å·ï¼š0x0100
    - ä¿ç•™å­—æ®µï¼š0x00000000
8. é‡å¤æ­¥éª¤4-6ç›´åˆ°å½“å‰æ‰‡åŒºæ•°æ®ä¼ è¾“å®Œæˆ
9. ä¸»èŠ‚ç‚¹æŸ¥è¯¢çŠ¶æ€åº”æ”¶åˆ°ï¼š`LIN_OTA_STATUS_FINISH`çŠ¶æ€ç 



### 3. ä¼ è¾“ç»“æŸé˜¶æ®µ
10. æ‰€æœ‰æ‰‡åŒºæ•°æ®ä¼ è¾“å®Œæˆåï¼Œä¸»èŠ‚ç‚¹å‘é€ç»“æŸå‘½ä»¤ï¼š
    - çŠ¶æ€ç ï¼š`LIN_OTA_CMD_END`
    - æ‰‡åŒºå·ï¼š0
    - å›ºä»¶ç‰ˆæœ¬å·ï¼š0x0100
    - ä¿ç•™å­—æ®µï¼š0x00000000
11. LINä»èŠ‚ç‚¹æ”¶åˆ°ç»“æŸå‘½ä»¤åå®Œæˆå›ºä»¶å‡çº§æµç¨‹

## äº”ã€å›¾è¡¨è¯´æ˜
![](https://cdn.nlark.com/yuque/__mermaid_v3/a81aef17b49c948a035a0e8eebac6f7b.svg)

### OTA å›ºä»¶å‡çº§æµç¨‹è¯´æ˜ï¼š
1. **åˆå§‹åŒ–å‡çº§**  

![](https://cdn.nlark.com/yuque/__mermaid_v3/ab6cad5a36f5f41f18b29e73a8ebe3f6.svg)

    - ç”¨æˆ·ç•Œé¢è°ƒç”¨ OTA å‡çº§å™¨ï¼Œä¼ å…¥å›ºä»¶æ•°æ®å’Œç‰ˆæœ¬å·
2. **LIN è®¾å¤‡å‡†å¤‡**  

![](https://cdn.nlark.com/yuque/__mermaid_v3/04e03aee83590ddade7d138b1fe14161.svg)

    - æ‰“å¼€ LIN è®¾å¤‡è¿æ¥  
    - å‘é€å‡çº§å¼€å§‹å‘½ä»¤
3. **æ‰‡åŒºæ•°æ®å†™å…¥**  

![](https://cdn.nlark.com/yuque/__mermaid_v3/cc80c8c78b25bd8cec4935097b63a29c.svg)

    - å¾ªç¯å¤„ç†æ¯ä¸ªæ‰‡åŒºï¼ˆå…± 128 å¸§/æ‰‡åŒºï¼‰  
    - æ¯å¸§å‘é€ 8 å­—èŠ‚æ•°æ®  
    - æŸ¥è¯¢å¹¶ç¡®è®¤æ‰‡åŒºå†™å…¥çŠ¶æ€
4. **å‡çº§å®Œæˆ**  

![](https://cdn.nlark.com/yuque/__mermaid_v3/76f72f9922746d9e491a23de8c8acb64.svg)

    - å‘é€å‡çº§ç»“æŸå‘½ä»¤  
    - é€šçŸ¥ç”¨æˆ·ç•Œé¢å‡çº§å®Œæˆ  
    - å…³é—­ LIN è®¾å¤‡è¿æ¥

## å…­ã€åè®®å…³é”®ç‚¹è¯´æ˜
1. **æ•°æ®åˆ†ç‰‡æœºåˆ¶**ï¼šç”±äºLINå¸§æ•°æ®åŸŸä»…8å­—èŠ‚ï¼Œ1Kæ•°æ®éœ€é€šè¿‡128å¸§`gID_OtapData_c`ä¼ è¾“
2. **CRCæ ¡éªŒæœºåˆ¶**ï¼šä»èŠ‚ç‚¹éœ€å¯¹æ¯ä¸ªæ‰‡åŒºæ•°æ®è®¡ç®—CRCå¹¶é€šè¿‡`gID_OtapGetStatus_c`è¿”å›
3. **ç‰ˆæœ¬ä¸€è‡´æ€§**ï¼šæ‰€æœ‰å‘½ä»¤å¸§éœ€åŒ…å«ç›¸åŒçš„å›ºä»¶ç‰ˆæœ¬å·ä»¥ç¡®ä¿ç‰ˆæœ¬ä¸€è‡´æ€§
4. **é”™è¯¯å¤„ç†**ï¼šå½“æ”¶åˆ°`LIN_OTA_STATUS_ABORT`çŠ¶æ€ç æ—¶ï¼Œä¸»èŠ‚ç‚¹åº”é‡æ–°å‘èµ·ä¼ è¾“æµç¨‹

### å…³é”®å‚æ•°è¯´æ˜ï¼š
| æ­¥éª¤ | æ•°æ®é‡ | è¯´æ˜ |
| --- | --- | --- |
| å•å¸§æ•°æ® | 8 å­—èŠ‚ | LIN æ€»çº¿æ ‡å‡†æ•°æ®å¸§å¤§å° |
| å•æ‰‡åŒºä¼ è¾“ | 128 å¸§ | å…± 1KB (128Ã—8=1024 å­—èŠ‚) |
| çŠ¶æ€ç¡®è®¤ | æ¯æ‰‡åŒºç»“æŸå | ç¡®ä¿æ•°æ®å®Œæ•´å†™å…¥ |


> **æ³¨æ„äº‹é¡¹**ï¼š  
>
> 1. æ¯ä¸ªæ‰‡åŒºå†™å…¥åå¿…é¡»ç­‰å¾…çŠ¶æ€ç¡®è®¤  
> 2. LIN è®¾å¤‡éœ€å®ç°"å‡†å¤‡å°±ç»ª"å’Œ"å®ŒæˆçŠ¶æ€"åè®®  
> 3. å¼‚å¸¸å¤„ç†éœ€åŒ…å«ï¼šè¶…æ—¶é‡ä¼ ã€æ ¡éªŒå¤±è´¥å›æ»šç­‰æœºåˆ¶
>

{% externalLinkCard "" "https://www.f123.club/" "https://www.f123.club/wp-content/uploads/2021/08/UN77_C6SA5GU39GBAWJ.png" %}

{% heatMapCard %}

{% tagRoulette "è®°å¿†è¡°é€€,è¡¨è¾¾æ¬²ä¸§å¤±,æ›´åŠ æ€ æƒ°,æ— æ„Ÿ,å¥½æƒ³ç¡è§‰" "ğŸ•¹ï¸" %}